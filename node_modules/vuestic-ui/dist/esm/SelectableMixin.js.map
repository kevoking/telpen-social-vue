{"version":3,"file":"SelectableMixin.js","sources":["../../src/mixins/SelectableMixin/SelectableMixin.ts"],"sourcesContent":["import { mixins, Options, prop, setup, Vue } from 'vue-class-component'\r\n\r\nimport ColorMixin from '../../services/color-config/ColorMixin'\r\nimport { FormComponentMixin } from '../FormComponent/FormComponentMixin'\r\nimport { StatefulMixin } from '../StatefulMixin/StatefulMixin'\r\nimport { LoadingMixin } from '../LoadingMixin/LoadingMixin'\r\n\r\nclass Props {\r\n  arrayValue = prop<string | Record<string, unknown>>({ type: [String, Object], default: '' })\r\n  label = prop<string>({ type: String, default: '' })\r\n  leftLabel = prop<boolean>({ type: Boolean, default: false })\r\n  trueValue = prop({ default: true })\r\n  falseValue = prop({ default: false })\r\n  indeterminate = prop<boolean>({ type: Boolean, default: false })\r\n  indeterminateValue = prop<boolean | any[] | string | Record<string, unknown>>({\r\n    type: [Boolean, Array, String, Object],\r\n    default: null,\r\n  })\r\n}\r\n\r\nconst PropsMixin = Vue.with(Props)\r\n\r\n@Options({\r\n  emits: ['update:modelValue', 'focus', 'blur'],\r\n})\r\nexport class SelectableMixin extends mixins(\r\n  ColorMixin,\r\n  StatefulMixin,\r\n  FormComponentMixin,\r\n  LoadingMixin,\r\n  PropsMixin,\r\n) {\r\n  isSelectableComponent!: boolean\r\n\r\n  created () {\r\n    this.isSelectableComponent = true\r\n    this.checkDuplicates()\r\n  }\r\n\r\n  get isChecked (): boolean {\r\n    if (this.modelIsArray) {\r\n      return this.modelValue && this.modelValue.includes(this.arrayValue)\r\n    }\r\n    return this.valueComputed === this.trueValue\r\n  }\r\n\r\n  get isIndeterminate (): boolean {\r\n    return this.valueComputed === this.indeterminateValue\r\n  }\r\n\r\n  get modelIsArray (): boolean {\r\n    return !!this.arrayValue\r\n  }\r\n\r\n  /** @public */\r\n  reset (): void {\r\n    this.$emit('update:modelValue', false)\r\n  }\r\n\r\n  checkDuplicates (): void {\r\n    // Just validating state values.\r\n    const values: any[] = [this.falseValue, this.trueValue]\r\n    if (this.indeterminate) {\r\n      values.push(this.indeterminateValue)\r\n    }\r\n    const hasDuplicates = new Set(values).size !== values.length\r\n    if (hasDuplicates) {\r\n      throw new Error('falseValue, trueValue, indeterminateValue props should have strictly different values, which is not the case.')\r\n    }\r\n  }\r\n\r\n  onFocus (event: FocusEvent): void {\r\n    this.$emit('focus', event)\r\n  }\r\n\r\n  onBlur (event: FocusEvent): void {\r\n    if (this.$refs.input === event.target && !this.isElementRelated(event.relatedTarget)) {\r\n      this.ValidateMixin_onBlur()\r\n      this.$emit('blur', event)\r\n    }\r\n  }\r\n\r\n  isElementRelated (element: any): boolean {\r\n    return [this.$refs.label, this.$refs.container].includes(element)\r\n  }\r\n\r\n  onWrapperClick (): void {\r\n    this.toggleSelection()\r\n  }\r\n\r\n  toggleSelection (): void {\r\n    if (this.readonly || this.disabled || this.loading) {\r\n      return\r\n    }\r\n    // For array access we pretend computedValue does not exist and use modelValue + emit input directly.\r\n    if (this.modelIsArray) {\r\n      if (!this.modelValue) {\r\n        this.$emit('update:modelValue', [this.arrayValue])\r\n      } else if (this.modelValue.includes(this.arrayValue)) {\r\n        this.$emit('update:modelValue', this.modelValue.filter((option: any) => option !== this.arrayValue))\r\n      } else {\r\n        this.$emit('update:modelValue', this.modelValue.concat(this.arrayValue))\r\n      }\r\n      return\r\n    }\r\n\r\n    if (this.indeterminate) {\r\n      if (this.isIndeterminate) {\r\n        this.valueComputed = this.trueValue\r\n      } else if (this.isChecked) {\r\n        this.valueComputed = this.falseValue\r\n      } else {\r\n        // unchecked\r\n        this.valueComputed = this.indeterminateValue\r\n      }\r\n      return\r\n    }\r\n\r\n    if (this.isChecked) {\r\n      this.valueComputed = this.falseValue\r\n    } else {\r\n      this.valueComputed = this.trueValue\r\n    }\r\n  }\r\n}\r\n"],"names":["PropsMixin","Vue","with","Props","constructor","this","prop","type","String","Object","default","Boolean","Array","SelectableMixin","mixins","ColorMixin","StatefulMixin","FormComponentMixin","LoadingMixin","created","isSelectableComponent","checkDuplicates","isChecked","modelIsArray","modelValue","includes","arrayValue","valueComputed","trueValue","isIndeterminate","indeterminateValue","reset","$emit","values","falseValue","indeterminate","push","Set","size","length","Error","onFocus","event","onBlur","$refs","input","target","isElementRelated","relatedTarget","ValidateMixin_onBlur","element","label","container","onWrapperClick","toggleSelection","readonly","disabled","loading","filter","option","concat","Options","emits"],"mappings":"mQAoBA,MAAMA,EAAaC,EAAIC,KAbvB,MAAMC,MAANC,cACEC,gBAAaC,EAAuC,CAAEC,KAAM,CAACC,OAAQC,QAASC,QAAS,KACvFL,WAAQC,EAAa,CAAEC,KAAMC,OAAQE,QAAS,KAC9CL,eAAYC,EAAc,CAAEC,KAAMI,QAASD,SAAS,IACpDL,eAAYC,EAAK,CAAEI,SAAS,IAC5BL,gBAAaC,EAAK,CAAEI,SAAS,IAC7BL,mBAAgBC,EAAc,CAAEC,KAAMI,QAASD,SAAS,IACxDL,wBAAqBC,EAAyD,CAC5EC,KAAM,CAACI,QAASC,MAAOJ,OAAQC,QAC/BC,QAAS,cASAG,EAAb,MAAaA,wBAAwBC,EACnCC,EACAC,EACAC,EACAC,EACAlB,IAIAmB,UACEd,KAAKe,uBAAwB,EAC7Bf,KAAKgB,kBAGPC,gBACE,OAAIjB,KAAKkB,aACAlB,KAAKmB,YAAcnB,KAAKmB,WAAWC,SAASpB,KAAKqB,YAEnDrB,KAAKsB,gBAAkBtB,KAAKuB,UAGrCC,sBACE,OAAOxB,KAAKsB,gBAAkBtB,KAAKyB,mBAGrCP,mBACE,QAASlB,KAAKqB,WAIhBK,QACE1B,KAAK2B,MAAM,qBAAqB,GAGlCX,kBAEE,MAAMY,EAAgB,CAAC5B,KAAK6B,WAAY7B,KAAKuB,WACzCvB,KAAK8B,eACPF,EAAOG,KAAK/B,KAAKyB,oBAGnB,GADsB,IAAIO,IAAIJ,GAAQK,OAASL,EAAOM,OAEpD,MAAM,IAAIC,MAAM,iHAIpBC,QAASC,GACPrC,KAAK2B,MAAM,QAASU,GAGtBC,OAAQD,GACFrC,KAAKuC,MAAMC,QAAUH,EAAMI,QAAWzC,KAAK0C,iBAAiBL,EAAMM,iBACpE3C,KAAK4C,uBACL5C,KAAK2B,MAAM,OAAQU,IAIvBK,iBAAkBG,GAChB,MAAO,CAAC7C,KAAKuC,MAAMO,MAAO9C,KAAKuC,MAAMQ,WAAW3B,SAASyB,GAG3DG,iBACEhD,KAAKiD,kBAGPA,kBACMjD,KAAKkD,UAAYlD,KAAKmD,UAAYnD,KAAKoD,UAIvCpD,KAAKkB,aACFlB,KAAKmB,WAECnB,KAAKmB,WAAWC,SAASpB,KAAKqB,YACvCrB,KAAK2B,MAAM,oBAAqB3B,KAAKmB,WAAWkC,QAAQC,GAAgBA,IAAWtD,KAAKqB,cAExFrB,KAAK2B,MAAM,oBAAqB3B,KAAKmB,WAAWoC,OAAOvD,KAAKqB,aAJ5DrB,KAAK2B,MAAM,oBAAqB,CAAC3B,KAAKqB,aAStCrB,KAAK8B,cACH9B,KAAKwB,gBACPxB,KAAKsB,cAAgBtB,KAAKuB,UACjBvB,KAAKiB,UACdjB,KAAKsB,cAAgBtB,KAAK6B,WAG1B7B,KAAKsB,cAAgBtB,KAAKyB,mBAK1BzB,KAAKiB,UACPjB,KAAKsB,cAAgBtB,KAAK6B,WAE1B7B,KAAKsB,cAAgBtB,KAAKuB,aAhGnBf,KAHZgD,EAAQ,CACPC,MAAO,CAAC,oBAAqB,QAAS,WAE3BjD"}